<!DOCTYPE html>
<html>
<head>
  <!-- Compiled and minified JavaScript -->
 
    
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    
<style>

.table-editable {
  position: relative;
  
  .glyphicon {
    font-size: 20px;
  }
}

.table-remove {
  color: #700;
  cursor: pointer;
  
  &:hover {
    color: #f00;
  }
}

.table-up, .table-down {
  color: #007;
  cursor: pointer;
  
  &:hover {
    color: #00f;
  }
}

.table-add {
  color: #070;
  cursor: pointer;
  position: absolute;
  top: 8px;
  right: 0;
  
  &:hover {
    color: #0b0;
  }
}
    </style>
</head>
    
    
    
<body>
    
    
    <div class="container">
  <div id="table" class="table-editable">
    <span class="table-add glyphicon glyphicon-plus"></span>
    <table class="table">
      <tr>
        <th>Action Name</th>
        <th>Action Type</th>
        <th>Action Class</th>
        <th>Parameters                           </th>
        <th></th>
        <th></th>
      </tr>
     
    </table>
  </div>
  
  <button id="stop-button" class="btn btn-primary">Stop</button>
  <button id="shutdown-button" class="btn btn-primary">Shutdown</button>

  <p id="export"></p>
</div>

    

<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
Â  <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>



<script>
$(function(){



var socket = io('http://localhost:3001', {transports: ['websocket'], upgrade: false});
 
socket.on('data', function(message){
	console.log('From Beaglebone to GUI ' + message.message);
});

$("#shutdown-button").on('click', function(){
	console.log("Shutdown")
	socket.emit('shutdown', "1")
})

$("#stop-button").on('click', function(){
	console.log("Stop")
	socket.emit('stop', "1")
})

var $TABLE = $('#table');

var global_nth_action = 0;
var global_mission = 0;

$('.table-add').click(function () {
  var nth_action = global_nth_action++;
  var mission = global_mission++;
  var $clone = 
  $TABLE.find('table').append('<tr><td contenteditable="true">Untitled Action</td><td contenteditable="false"><select id = "action_type_'+ mission + '_' + nth_action +'"><option value="BLANK"></option><option value="ARM">ARM</option><option value="DRIVE">DRIVE</option><option value="HAND">HAND</option></select></td><td id = "action_class_' + mission +"_" + nth_action+'"></td><td></td><td><span class="table-remove glyphicon glyphicon-remove"></span></td><td><span class="table-up glyphicon glyphicon-arrow-up"></span><span class="table-down glyphicon glyphicon-arrow-down"></span></td></tr>');

 var action_selector = $("#action_type_"+ mission + "_" + nth_action);
 action_selector.on("change", function(){
   console.log("What the fuck")
       console.log(action_selector.val());

   var class_to_change = $("#action_class_"+ mission + "_" + nth_action);
   class_to_change.empty();

   if(action_selector.val() == "ARM"){
     console.log(class_to_change)
     class_to_change.append('<select class="ARM_ACTIONS"> <option value="PRESS">PRESS</option><option value="LEVER">LEVER</option><option value="VALVE">VALVE</option><option value="DRILL">DRILL</option></select>');
   }
   else if(action_selector.val() == "DRIVE"){
    
      class_to_change.append(' <select class="DRIVE_ACTIONS"><option value="DIST_HEAD">DIST HEAD</option><option value="GPS">GPS</option></select>');
   }
   else if(action_selector.val() == "HAND"){
     class_to_change.append(' <select class="HAND_ACTIONS"><option value="GRAB">GRAB</option><option value="ROTATE">ROTATE</option></select>');
   }
   

   
 });
   
    
$('.table-remove').on('click', function () {
  console.log("YAY");
  $(this).parents('tr').detach();
});
  
  

$('.table-up').on('click', function () {
  var $row = $(this).parents('tr');
  if ($row.index() === 1) return; // Don't go above the header
  $row.prev().before($row.get(0));
});

$('.table-down').click(function () {
  var $row = $(this).parents('tr');
  $row.next().after($row.get(0));
});    
});
    });
    
</script>

<script>

</script>

</body>
</html>
